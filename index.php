<?php include('./header.php'); ?><?phptry{  $dbh = new PDO('sqlite:blog.db','','');   //PDOクラスのオブジェクトの作成  $sth = $dbh->prepare("select * from posts order by id desc");   //prepareメソッドでSQL文の準備  $sth->execute();   //準備したSQL文の実行  while ($row = $sth->fetch()) {    //テーブルの内容を１行ずつ処理    $time = preg_split("/[\s.:-]+/",$row['date']);    ?>    <h1><?php echo $row['title'] ?><small>(<?php echo $time[0]."年".$time[1]."月". $time[2]."日 ".$time[3].":".$time[4] ?>)</small></h1>    <div class='text'>      <div class="blog_content">        <?php        echo nl2br($row['contents']);        #echo $row['contents']        ?>      </div>      <div class='form'>        <form action="edit.php" method="post">          <input type="submit" value="編集" class='sbt'>          <input type="hidden" name="id" value="<?php echo $row["id"] ?>">        </form>        <form action="delete.php" method="post">          パスワード:<input type="password" name="password" size="15">          <input type="submit" value="削除" class='sbt' />          <input type="hidden" name="id" value="<?php echo $row["id"]?>">        </form>      </div>      <hr>      コメント:      <?php      $sql = "select * from comments where pid = ?";      $sth2 = $dbh->prepare($sql);      $sth2->execute(array($row["id"]));      while ($row2 = $sth2->fetch()) {        $time2 = preg_split("/[\s.:-]+/",$row2['date']);        ?>        <div class='comment'>          <?php echo $row2['contents'] ?>          <small>(<?php echo $time2[0]."年".$time2[1]."月". $time2[2]."日 ".$time2[3].":".$time2[4] ?>)</small>        </div>        <?php      }      ?>      <form action="comment.php" method="post">        <div>          <textarea name="contents" rows="w" cols="50"></textarea>          <input type="hidden" name="pid" value="<?php echo $row['id'] ?>">          <input type="submit" value="コメントする" class="sbt">        </div>      </form>    </div>    <?php  }}Catch (PDOException $e) {  print "エラー!: " . $e->getMessage() . "<br/>";  die();}?><?php include('./footer.php'); ?>